import io
import pdfplumber
import logging

# Configure logger for this module
logger = logging.getLogger(__name__)

def extract_text_from_pdf(pdf_bytes: bytes) -> str:
    """
    Extracts all text from a PDF file provided as bytes.
    
    Args:
        pdf_bytes: The content of the PDF file in bytes.

    Returns:
        A single string containing all the extracted text from the PDF.
    """
    if not pdf_bytes:
        logger.warning("extract_text_from_pdf received empty bytes.")
        return ""
        
    full_text = []
    try:
        with pdfplumber.open(io.BytesIO(pdf_bytes)) as pdf:
            for page in pdf.pages:
                text = page.extract_text(x_tolerance=2)
                if text:
                    full_text.append(text)
        logger.info("Successfully extracted text from PDF.")
        return "\n".join(full_text)
    except Exception as e:
        logger.error(f"Failed to extract text from PDF: {e}", exc_info=True)
        return ""
